import angr

def print_str():
    print("angrEXplore: v1.0\n")

def main():
    binary = input("> Diretório: ")
    enddr = int(input("> Endereço (em hexadecimal): "), 16)  # Converte o endereço para hexadecimal

    # Carregar o binário
    project = angr.Project(binary, auto_load_libs=False)

    # Criar o estado inicial
    state = project.factory.entry_state()

    # Criar o gerenciador de simulação
    simgr = project.factory.simulation_manager(state)

    # Explorar o binário
    simgr.explore(find=enddr)

    # Verificar se um caminho foi encontrado
    if simgr.found:
        print("[+] Caminho encontrado: ", simgr.found[0].posix.dumps(0))
    else:
        print("[!] Caminho não encontrado...")

if __name__ == "__main__":
    print_str()
    main()
